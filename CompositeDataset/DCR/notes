created two processes for this, one as close to the source as possible and one that is a clean version that makes much more sense / is much more realistic

In the clean version, you could make several requirements that require looking into endpoints
